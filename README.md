# PDFMalwareDetector
Project work for the Machine learning and Data mining course, A.Y. 2022-2023

The dataset used for this work is available here:
https://www.unb.ca/cic/datasets/pdfmal-2022.html



## Repository structure:

        ├── classifying                        directory containing the python modules necessary for classifying the user-inputed PDF file     	            
        │    ├ create_dataframe.py                code to produce the training set for the user-inputed PDF classification task         		
        │    ├ extract_features.py                contains the method necessary to exctract the features from the input PDF            
        │    ├ reduced_cn2_rule_classifier.py 	  module to build the CN2 model for the classification task and to perform the classification 
        │    ├ reduced_trees.py                   module to build the Adaboost and DecisionTree models for the classification task and to perform the classification   		     
        ├── data_preprocessing                  directory containing the preprocessing phase modules
        │    ├ cleaning.py                        module for the main preprocessing, which is cleaning data and filling missing values
        │    ├ discretization.py                  module containing the two discretization methods
        │    ├ feature_selection.py               module containing the feature selection method (mutual info)     
        ├── datasets                            directory containing all the .csv files            
        │    ├ CategoricalTraining/TestSet.csv     train and test set in a categorical-discretized form 
        │    ├ ContinuousTraining/TestSet.csv      train and test set in a continuous form     
        │    ├ ClassificationTraining/TestSet.csv  train and test set for the classification task, where test set is just the user-inputed PDF
        │    ├ PDFMalware2022.csv                  original dataset
        │    ├ ToClassify.csv                      features values extracted from the PDF
        ├── GUI                                 directory containing the GUI modules
        │    ├ main_window.py                      entry point of the application, main GUI page code 
        │    ├ result_window.py                    code of the window used to display the results of classification task     
        ├── learning                            directory containing the python modules used to learn the complete models on selected features    	            
        │    ├ association_rules.py                module used to compute the association rules from the categorical dataset by using apriori algorithm         		
        │    ├ cn2_rule_classifier.py              module used to build the CN2 model trained on main dataset and to evaluate its performances
        │    ├ trees.py 	                         module to build the Adaboost and DecisionTree models on main dataset and to evaluate their performances
        │    ├ utils.py                            module contatining some util methods, such as method to save rules from classifiers
        ├── models                               directory containing all the files relative to the models 
        │    ├ plots                                directory containing the tree_plots for both the main and the surrogated tree-based classifiers
        │    ├ results                              directory containing the performance evaluation results   
        │    │  ├ test                              results obtained on test sets
        │    │  └ validation                        results obtained on validation sets  
        │    ├ rules                             directory containing the rules produced by the main classifiers
        │    ├ surrogated_models                 directory containing the same informations for the surrogated models
        │    │  ├ reduced_results                    results obtained by the surrogated classifiers on validation set (CN2 has no validation phase)  
        │    │  ├ reduced_rules                      directory containing the rules produced by the surrogated classifiers
        │    │  ├ Adaboost_reduced_model.pkl         reduced Adaboost model
        │    │  ├ DecisionTree_reduced_model.pkl     reduced DecisionTree model
        │    │  └ CN2_learner_reduced_model          reduced CN2 model
        ├── pdf                                   directory where the user-inputed PDF gets saved
        ├── requirements.txt                      file containing all the necessary libraries to run the code	    
        └── README.md                             readme file, explaining repo' structure and code usage
        

## Installation

**Create virtual enviroment:**<br>
<code>cd PDFMalwareDetector</code><br>
<code> python -m venv PDFMalwareDetector </code>

**Install requirements:**<br>
<code>pip install -r requirements.txt</code>
* aspose_words==22.12.0
* beautifulsoup4==4.11.1
* matplotlib==3.6.2
* mlxtend==0.21.0
* numpy==1.23.5
* orange3==3.34.0
* pandas==1.5.2
* PyPDF2==2.12.1
* PySimpleGUI==4.60.4
* scikit_learn==1.2.0
* scipy==1.10.0
* seaborn==0.12.2

**python version used: 3.9**




## How to run the code
The application can be started from cmd in the following way: <br>
 After installing the requirements, use the following commands<br>
      <code>cd "PDFMalwareDetector"</code> <br>
      <code>python -m GUI.main_window</code> <br>
      
After the application is running, select a pdf file of your choice and the classifier you want to test.
Classification will take some seconds to perform, then another window will display the classification result, the classification path (for Adaboost and DecisionTree) and the rules produced by the classifier
